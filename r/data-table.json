{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "data-table",
  "title": "Data Table",
  "description": "Complete data table component with sorting and pagination. Composes table primitives with pagination functionality.",
  "registryDependencies": [
    "@rost/rost-ui-styles",
    "@rost/table",
    "@rost/data-table-pagination"
  ],
  "files": [
    {
      "path": "components/ui/data-table.tsx",
      "content": "import * as React from \"react\";\n\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"./table\";\nimport { DataTablePagination } from \"./data-table-pagination\";\nimport { cn } from \"./utils\";\n\nexport type SortDirection = \"asc\" | \"desc\";\n\nexport type DataTableSort<TData> = {\n  key: keyof TData;\n  direction: SortDirection;\n};\n\nexport type DataTableColumn<TData> = {\n  header: React.ReactNode;\n  accessor?: keyof TData;\n  sortKey?: keyof TData;\n  sortable?: boolean;\n  sortValue?: (row: TData) => string | number;\n  cell?: (row: TData) => React.ReactNode;\n  className?: string;\n  headerClassName?: string;\n};\n\nexport type DataTableProps<TData> = React.HTMLAttributes<HTMLDivElement> & {\n  data: TData[];\n  columns: Array<DataTableColumn<TData>>;\n  emptyMessage?: React.ReactNode;\n  sort?: DataTableSort<TData> | null;\n  defaultSort?: DataTableSort<TData> | null;\n  onSortChange?: (sort: DataTableSort<TData> | null) => void;\n  pageSize?: number;\n  pageIndex?: number;\n  defaultPageIndex?: number;\n  onPageChange?: (pageIndex: number) => void;\n  showPagination?: boolean;\n};\n\n/**\n * Complete data table component with sorting, pagination, and empty states.\n * Composes table primitives with pagination functionality.\n *\n * @example\n * ```tsx\n * <DataTable\n *   data={users}\n *   columns={columns}\n *   pageSize={10}\n *   defaultSort={{ key: \"name\", direction: \"asc\" }}\n * />\n * ```\n */\nexport function DataTable<TData>({\n  className,\n  data,\n  columns,\n  emptyMessage = \"No data available\",\n  sort,\n  defaultSort = null,\n  onSortChange,\n  pageSize,\n  pageIndex,\n  defaultPageIndex = 0,\n  onPageChange,\n  showPagination = true,\n  ...props\n}: DataTableProps<TData>) {\n  const [internalSort, setInternalSort] = React.useState<DataTableSort<TData> | null>(\n    defaultSort\n  );\n  const [internalPageIndex, setInternalPageIndex] = React.useState(defaultPageIndex);\n\n  const resolvedSort = sort ?? internalSort;\n  const resolvedPageIndex = pageIndex ?? internalPageIndex;\n\n  const sortedData = React.useMemo(() => {\n    if (!resolvedSort) return data;\n    const column = columns.find((item) =>\n      [item.sortKey, item.accessor].includes(resolvedSort.key)\n    );\n    const getValue = column?.sortValue ?? ((row: TData) => row[resolvedSort.key]);\n\n    return [...data].sort((left, right) => {\n      const leftValue = getValue(left);\n      const rightValue = getValue(right);\n\n      if (typeof leftValue === \"number\" && typeof rightValue === \"number\") {\n        return resolvedSort.direction === \"asc\"\n          ? leftValue - rightValue\n          : rightValue - leftValue;\n      }\n\n      const leftString = String(leftValue ?? \"\");\n      const rightString = String(rightValue ?? \"\");\n      return resolvedSort.direction === \"asc\"\n        ? leftString.localeCompare(rightString)\n        : rightString.localeCompare(leftString);\n    });\n  }, [columns, data, resolvedSort]);\n\n  const totalPages = pageSize ? Math.max(1, Math.ceil(sortedData.length / pageSize)) : 1;\n  const clampedPageIndex = Math.min(Math.max(resolvedPageIndex, 0), totalPages - 1);\n\n  React.useEffect(() => {\n    if (pageIndex === undefined && clampedPageIndex !== resolvedPageIndex) {\n      setInternalPageIndex(clampedPageIndex);\n    }\n  }, [clampedPageIndex, pageIndex, resolvedPageIndex]);\n\n  const pagedData = React.useMemo(() => {\n    if (!pageSize) return sortedData;\n    const start = clampedPageIndex * pageSize;\n    return sortedData.slice(start, start + pageSize);\n  }, [clampedPageIndex, pageSize, sortedData]);\n\n  const handleSortChange = (nextSort: DataTableSort<TData> | null) => {\n    if (onSortChange) {\n      onSortChange(nextSort);\n      return;\n    }\n    setInternalSort(nextSort);\n  };\n\n  const handlePageChange = (nextPageIndex: number) => {\n    if (onPageChange) {\n      onPageChange(nextPageIndex);\n      return;\n    }\n    setInternalPageIndex(nextPageIndex);\n  };\n\n  return (\n    <div className={cn(\"rost-data-table\", className)} {...props}>\n      <Table>\n        <TableHeader>\n          <TableRow>\n            {columns.map((column, index) => {\n              const sortKey = column.sortKey ?? column.accessor;\n              const isSortable = Boolean(column.sortable && sortKey);\n              const isSorted = Boolean(isSortable && resolvedSort?.key === sortKey);\n              const direction = isSorted ? resolvedSort?.direction : undefined;\n              const ariaSort = isSorted\n                ? direction === \"asc\"\n                  ? \"ascending\"\n                  : \"descending\"\n                : \"none\";\n\n              const handleSort = () => {\n                if (!isSortable || !sortKey) return;\n                if (!isSorted) {\n                  handleSortChange({ key: sortKey, direction: \"asc\" });\n                  return;\n                }\n                if (direction === \"asc\") {\n                  handleSortChange({ key: sortKey, direction: \"desc\" });\n                  return;\n                }\n                handleSortChange(null);\n              };\n\n              return (\n                <TableHead\n                  key={index}\n                  className={column.headerClassName}\n                  aria-sort={isSortable ? ariaSort : undefined}\n                >\n                  {isSortable ? (\n                    <button\n                      type=\"button\"\n                      className={cn(\n                        \"rost-table__sort\",\n                        isSorted && \"rost-table__sort--active\"\n                      )}\n                      onClick={handleSort}\n                    >\n                      <span>{column.header}</span>\n                      <span className=\"rost-table__sort-indicator\">\n                        {direction === \"asc\" ? \"↑\" : direction === \"desc\" ? \"↓\" : \"\"}\n                      </span>\n                    </button>\n                  ) : (\n                    column.header\n                  )}\n                </TableHead>\n              );\n            })}\n          </TableRow>\n        </TableHeader>\n        <TableBody>\n          {pagedData.length === 0 ? (\n            <TableRow>\n              <TableCell colSpan={columns.length} className=\"rost-data-table__empty\">\n                {emptyMessage}\n              </TableCell>\n            </TableRow>\n          ) : (\n            pagedData.map((row, rowIndex) => (\n              <TableRow key={rowIndex}>\n                {columns.map((column, columnIndex) => (\n                  <TableCell key={columnIndex} className={column.className}>\n                    {column.cell\n                      ? column.cell(row)\n                      : column.accessor\n                        ? String(row[column.accessor] ?? \"\")\n                        : null}\n                  </TableCell>\n                ))}\n              </TableRow>\n            ))\n          )}\n        </TableBody>\n      </Table>\n      {pageSize && showPagination ? (\n        <div className=\"rost-data-table__footer\">\n          <DataTablePagination\n            pageIndex={clampedPageIndex}\n            pageSize={pageSize}\n            totalCount={sortedData.length}\n            onPageChange={handlePageChange}\n          />\n        </div>\n      ) : null}\n    </div>\n  );\n}\n",
      "type": "registry:component",
      "target": "components/ui/data-table.tsx"
    }
  ],
  "type": "registry:component"
}